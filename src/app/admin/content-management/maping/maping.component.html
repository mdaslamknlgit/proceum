<div class="mn_dshbrd">
  <div class="cust_mdl_par {{ modal_popup ? 'cust_mdl_opn' : '' }}">
    <div class="cust_mdl_chl">
      <div class="pg_ttl mpng_pp_hd">
        <strong>{{"admin.mng_cnt.lnk_cnt.linking_to"|translate}} : </strong> {{ link_to_string }}
        <span class="spacer"></span>
        <button mat-icon-button (click)="closeModal()">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      <div class="tbbd_bdy">
        <div class="hgt_20"></div>
        <div class="dsh_brd_crds">
          <mat-form-field appearance="outline" class="float_right">
            <input [(ngModel)]="content_search_box" (keyup)="$event.keyCode == 13 ? doFilter() : ''" matInput
              placeholder="{{'search_text'|translate}}" />
            <mat-icon matSuffix (click)="doFilter()">search</mat-icon>
          </mat-form-field>
        </div>
        <div class="rsp_tbl popup_mid_div">
          <table mat-table [dataSource]="dataSource" class="whtspc_nml">
            <ng-container matColumnDef="s_no">
              <th mat-header-cell *matHeaderCellDef>{{"select_text"|translate}}</th>
              <td mat-cell *matCellDef="let element">
                <mat-checkbox [value]="element['id']" [checked]="
                    slected_content_ids[element['id']] != undefined
                      ? slected_content_ids[element['id']]['is_selected']
                      : false
                  " (change)="selectContent($event, element['id'])"></mat-checkbox>
              </td>
            </ng-container>

            <ng-container matColumnDef="title">
              <th mat-header-cell *matHeaderCellDef>{{"admin.mng_cnt.mng_cnt.content_title"|translate}}</th>
              <td mat-cell *matCellDef="let element">{{ element.title }}</td>
            </ng-container>

            <ng-container matColumnDef="created_by">
              <th mat-header-cell *matHeaderCellDef>{{"admin.mng_cnt.mng_cnt.created_by"|translate}}</th>
              <td mat-cell *matCellDef="let element">
                {{ element.created_by }}
              </td>
            </ng-container>
            <ng-container matColumnDef="created_date">
              <th mat-header-cell *matHeaderCellDef>{{"admin.mng_cnt.mng_cnt.create_date"|translate}}</th>
              <td mat-cell *matCellDef="let element">
                {{ element.created_at }}
              </td>
            </ng-container>
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>{{"actions_text"|translate}}</th>
              <td mat-cell *matCellDef="let element">
                <a *ngIf="user['role'] == '1'" href="/admin/create-content/{{ element['id'] }}" target="_blank">{{"admin.mng_cnt.lnk_cnt.view"|translate}}</a>
                <a *ngIf="user['role'] == '3' || user['role'] == '4' || user['role'] == '5' || user['role'] == '6' || user['role'] == '7'"
                  href="/reviewer/create-content/{{ element['id'] }}" target="_blank">{{"admin.mng_cnt.lnk_cnt.view"|translate}}</a>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            <tr class="mat-row no_rcrds_fd" *matNoDataRow>
              <td colspan="5" style="text-align: center; margin: 20px" class="mat-cell"
                [attr.colspan]="displayedColumns.length">
                {{"no_records_found_text"|translate}}
              </td>
            </tr>
          </table>
        </div>
        <mat-paginator [pageSizeOptions]="page_size_options" #content_paginator [length]="content_totalSize"
          [pageSize]="content_pageSize" showFirstLastButtons (page)="contentGetServerData($event)"></mat-paginator>
        <hr />
        <div class="float_right">
          <button mat-raised-button (click)="closeModal()" class="mr_1 gry_btn">
            {{"close"|translate}}
          </button>
          <button mat-raised-button (click)="linkContent()" color="accent">
            {{"save_text"|translate}}
          </button>
        </div>
        <div class="hgt_20"></div>
      </div>
    </div>
  </div>
  <div class="brd_crm">{{"proceum_text"|translate}} &raquo; <strong>{{"admin.mng_cnt.lnk_cnt.page_title"|translate}}</strong></div>
  <div class="pg_ttl">{{"admin.mng_cnt.lnk_cnt.page_title"|translate}}</div>
  <hr />
  <div class="dsh_brd_crds">
    <div *ngIf="curriculum_list == undefined">
      {{"no_courses_found_text"|translate}}
    </div>
    <div>
      <div *ngIf="curriculum_list != undefined" class="cm_fltr_sc mr_1">
        <span>{{"select_course"|translate}}</span>
        <div class="clear_fix"></div>
        <mat-form-field appearance="outline">
          <mat-select [(ngModel)]="curriculum_id" (ngModelChange)="applyFilters(0)">
            <mat-option *ngFor="let value of curriculum_list" [value]="value['pk_id']"
              [matTooltip]="value['curriculumn_name']">{{ value["curriculumn_name"] }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="cm_fltr_sc mr_1" *ngFor="let value of curriculum_labels; let i = index">
        <div *ngIf="i < curriculum_labels.length - 1">
          <span>{{ ucFirst(value["display_label"]) }}</span>
          <div class="clear_fix"></div>
          <mat-form-field appearance="outline">
            <mat-select placeholder="Select {{ ucFirst(value['display_label']) }}"
              [(ngModel)]="selected_level[value['level_number']]" (ngModelChange)="
                applyFilters(value['level_number']);
                getLevels(value['level_number'])
              ">
              <mat-option>
                <ngx-mat-select-search [noEntriesFoundLabel]="'No '+ ucFirst(value['display_label'])+' found'"
                  name="search_topic" ngModel (ngModelChange)="searchLevelByName($event,value['level_number'])"
                  [placeholderLabel]="'Search '+ucFirst(value['display_label'])">Select
                  {{ucFirst(value['display_label'])}}
                </ngx-mat-select-search>
              </mat-option>
              <mat-option *ngFor="let level of level_options[value['level_number']]" [value]="level['pk_id']"
                [matTooltip]="level['level_name']">{{level["level_name"] }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
    </div>

    <div class="rsp_tbl" *ngIf="stepsDisplayedColumns.length > 2">
      <table mat-table [dataSource]="stepsDataSource">
        <ng-container matColumnDef="s_no">
          <th mat-header-cell *matHeaderCellDef>{{"s_no_text"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.s_no }}</td>
        </ng-container>

        <ng-container *ngFor="let label of curriculum_labels" matColumnDef="{{ label['display_label'] }}">
          <th mat-header-cell *matHeaderCellDef>
            {{ ucFirst(label["display_label"]) }}
          </th>
          <td mat-cell *matCellDef="let element" class="ws_normal">
            {{ element["level_name_" + label["level_number"]] }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>{{"actions_text"|translate}}</th>
          <td mat-cell *matCellDef="let element; let i = dataIndex">
            <a (click)="openModal(element)">{{"admin.mng_cnt.lnk_cnt.link_content"|translate}}</a>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="stepsDisplayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: stepsDisplayedColumns"></tr>
        <tr class="mat-row no_rcrds_fd" *matNoDataRow>
          <td style="text-align: center; margin: 20px" class="mat-cell" [attr.colspan]="stepsDisplayedColumns.length">
            {{"no_records_found_text"|translate}}
          </td>
        </tr>
      </table>
    </div>
    <mat-paginator #paginator [pageSizeOptions]="page_size_options" [length]="totalSize" [pageSize]="pageSize"
      showFirstLastButtons (page)="getServerData($event)"></mat-paginator>
  </div>
</div>