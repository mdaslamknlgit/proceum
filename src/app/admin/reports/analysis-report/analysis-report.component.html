<div class="mn_dshbrd">
    <div class="brd_crm">{{"proceum_text"|translate}} &raquo; <strong>{{"admin.side_menu.analysis_report"|translate}}</strong></div> 
    
    <div class="d-flex rsp_fw">
        <div class="pg_ttl">{{"admin.side_menu.analysis_report"|translate}}</div>
        <div class="spacer"></div>
    </div>
    <hr />
    <div>
        <div class="cm_fltr_sc mr_1">
            <span>{{"organization_type"|translate}} <span class="required">*</span></span>
            <mat-form-field appearance="outline" class="w_100p">
                <mat-select placeholder='{{"select"|translate}} {{"organization_type"|translate}}'
                    name="organization_edit" #organization_edit="ngModel" [(ngModel)]="organization_type_id"
                    (ngModelChange)="onOrganizationTypeChange()">
                    <mat-option *ngFor="let item of organization_types" [value]="item.value">{{ item.viewValue }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="cm_fltr_sc mr_1" *ngIf="is_university">
            <span>{{ organization_type_name ? organization_type_name : 'Organization List' }} </span>
            <mat-form-field appearance="outline">
                <mat-select placeholder="{{'select_text'|translate}} {{ organization_type_name }}" name="organization_list_edit"
                    #organization_list_edit="ngModel" [(ngModel)]="organization_list_id"
                    (ngModelChange)="selected_name='university_id';selected_value=organization_list_id;getCollege(organization_type_id,0,'year')">
                    <mat-option>
                        <ngx-mat-select-search [noEntriesFoundLabel]="'no_records_found_text'|translate"
                            [placeholderLabel]="'search_text'|translate" name="search_university" ngModel
                            (ngModelChange)="searchOrganizations($event)">
                        </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of all_organization_list | async" [value]="item['pk_id']" matTooltip='{{ item["organization_name"] }}'>{{
                        item["organization_name"] }}</mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="cm_fltr_sc mr_1" *ngIf="is_college">
            <span>{{"admin.assessment.create.college"|translate}}</span>
            <mat-form-field appearance="outline">
                <mat-select placeholder="{{'admin.assessment.create.select_college' | translate}}"
                    name="college_edit" #college_edit="ngModel" [(ngModel)]="college_id"
                    (ngModelChange)="selected_name='college_id';selected_value=college_id;getYearSemsterGroup(organization_type_id,0,'year')">
                    <mat-option>
                        <ngx-mat-select-search [noEntriesFoundLabel]="'no_records_found_text'|translate"
                            [placeholderLabel]="'search_text'|translate" name="search_college" ngModel
                            (ngModelChange)="searchCollege($event)">
                        </ngx-mat-select-search>
                    </mat-option>
                    <mat-option *ngFor="let item of all_college | async" [value]="''+item['pk_id']" matTooltip='{{
                        item["organization_name"]?item["organization_name"]:item["partner_name"] }}'>{{
                        item["organization_name"]?item["organization_name"]:item["partner_name"] }}</mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="cm_fltr_sc mr_1">
            <span>{{"admin.assessment.create.year"|translate}}</span>
            <mat-form-field appearance="outline">
                <mat-select placeholder="{{'admin.assessment.create.select_year'|translate}}" name="year_edit"
                    #year_edit="ngModel" [(ngModel)]="year_id"
                    (ngModelChange)="selected_name='year_id';selected_value=year_id;getYearSemsterGroup(organization_type_id,year_id,'semester');doFilter();">
                    <mat-option *ngFor="let item of all_years | async" [value]="item['pk_id']">{{ item["name"] }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="cm_fltr_sc mr_1" *ngIf="show_semester_dropdown">
            <span>{{"admin.assessment.create.semester"|translate}}</span>
            <mat-form-field appearance="outline">
                <mat-select placeholder="{{'admin.assessment.create.select_semester'|translate}}"
                    name="semester_edit" #semester_edit="ngModel" [(ngModel)]="semester_id"
                    (ngModelChange)="selected_name='semester_id';selected_value=semester_id;getYearSemsterGroup(organization_type_id,semester_id,'group');doFilter();">
                    <mat-option *ngFor="let item of all_semesters | async" [value]="item['pk_id']">{{ item["name"]
                        }}</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="cm_fltr_sc mr_1" *ngIf="show_group_dropdown">
            <span>{{"admin.assessment.create.group"|translate}}</span>
            <mat-form-field appearance="outline">
                <mat-select placeholder="{{'admin.assessment.create.select_group'|translate}}" name="group_edit"
                    #group_edit="ngModel" [(ngModel)]="group_id"
                    (ngModelChange)="selected_name='group_id';selected_value=group_id;">
                    <mat-option *ngFor="let item of all_groups | async" [value]="item['pk_id']">{{ item["name"] }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="cm_fltr_sc mr_1">
            <span>{{"admin.report.order_list.duration"|translate}}</span>
            <mat-form-field appearance="outline">
                <mat-select placeholder="Select Duration" name="duration" [(ngModel)]="duration" (ngModelChange)="applyFilters()">
                    <mat-option [value]="">{{"admin.report.order_list.all"|translate}}</mat-option>
                    <mat-option [value]="'today'">{{"admin.report.order_list.today"|translate}}</mat-option>
                    <mat-option [value]="'this_week'">{{"admin.report.order_list.this_week"|translate}}</mat-option>
                    <mat-option [value]="'this_month'">{{"admin.report.order_list.this_month"|translate}}</mat-option>
                    <mat-option [value]="'3'">{{"admin.report.order_list.3months"|translate}}</mat-option>
                    <mat-option [value]="'6'">{{"admin.report.order_list.6months"|translate}}</mat-option>
                    <mat-option [value]="'9'">{{"admin.report.order_list.9months"|translate}}</mat-option>
                    <mat-option [value]="'this_year'">{{"admin.report.order_list.1year"|translate}}</mat-option>
                    <mat-option [value]="'date_range'">{{"admin.report.order_list.date_range"|translate}}</mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="cm_fltr_sc mr_1 {{date_range_fltr == false ? 'd_none':''}}">
            <div class="crt_prt_hd">{{"admin.report.order_list.date_range"|translate}}</div>
            <mat-form-field appearance="outline">
              <mat-date-range-input [rangePicker]="picker">
                <input matStartDate placeholder='{{"admin.report.order_list.start_date"|translate}}' [(ngModel)]="from_date" (dateChange)="fromdateChange()" readonly>
                <input matEndDate placeholder='{{"admin.report.order_list.end_date"|translate}}' [(ngModel)]="to_date" (dateChange)="todateChange()" [disabled]="is_todate" readonly>
              </mat-date-range-input>
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-date-range-picker #picker></mat-date-range-picker>
            </mat-form-field>
        </div>    
    </div>
    <div class="hgt_10"></div>
    <div>
        <div class="rsp_tbl">
            <table mat-table [dataSource]="dataSource" matSort>
                <ng-container matColumnDef="s_no">
                    <th mat-header-cell *matHeaderCellDef>{{"s_no_text"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.s_no }}</td>
                </ng-container>
                <ng-container matColumnDef="assessment_name">
                    <th mat-header-cell *matHeaderCellDef>{{"admin.report.ass_rpt.assessment_name"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.assessment_name }}</td>
                </ng-container>
                <ng-container matColumnDef="date_time">
                    <th mat-header-cell *matHeaderCellDef>{{"admin.report.ass_rpt.date_time"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.assessment_date_time }}</td>
                </ng-container>
                <ng-container matColumnDef="conducted_by">
                    <th mat-header-cell *matHeaderCellDef>{{"admin.report.ass_rpt.conducted_by"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.created_by }}</td>
                </ng-container>
                <ng-container matColumnDef="students_appeared">
                    <th mat-header-cell *matHeaderCellDef>{{"admin.report.ass_rpt.students_appeared"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.students_appreared }}</td>
                </ng-container>
                <ng-container matColumnDef="students_passed">
                    <th mat-header-cell *matHeaderCellDef>{{"admin.report.ass_rpt.students_passed"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.students_passed }}</td>
                </ng-container>
                <ng-container matColumnDef="questions">
                    <th mat-header-cell *matHeaderCellDef>{{"admin.report.ass_rpt.questions"|translate}}</th>
                    <td mat-cell *matCellDef="let element">{{ element.total_questions_count }}</td>
                </ng-container>
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>{{"actions_text"|translate}}</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button color="accent">
                            <mat-icon routerLink="/admin/reports/assessment-report/{{element.pk_id}}/{{element.assessment_key}}/{{organization_type_id}}/{{organization_list_id}}/{{college_id}}/{{year_id}}/{{semester_id}}/{{group_id}}" matTooltip="{{'click_to_view_report_text'|translate}}">visibility</mat-icon>
                        </button>
                    </td>
                </ng-container>
                
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                <tr class="mat-row no_rcrds_fd" *matNoDataRow>
                    <td class="mat-cell" colspan="9">{{"no_records_found_text"|translate}}</td>
                </tr>
            </table>
        </div>
        <mat-paginator [pageSizeOptions]="page_size_options" [length]="totalSize" showFirstLastButtons (page)="getServerData($event)">
        </mat-paginator>
    </div>

</div>