<div class="mn_dshbrd">
  <div class="brd_crm">
    {{"proceum_text"|translate}} &raquo; {{"admin.side_menu.user_management"|translate}} &raquo; <strong>{{"admin.side_menu.login_history"|translate}}</strong>
  </div>
  <div class="pg_ttl">{{"admin.side_menu.login_history"|translate}}</div>

  <div class="dsh_brd_crds inputs_wdth_200">
    <div class="d_flx_ac">
      <mat-form-field appearance="outline" class="mr_1">
        <input
          matInput
          (keyup)="$event.keyCode == 13 ? applyFilters() : ''"
          [(ngModel)]="search_txt"
          placeholder="{{'search_text'|translate}}"
        />
        <mat-icon matSuffix (click)="applyFilters()">search</mat-icon>
      </mat-form-field>
      <mat-form-field appearance="outline" class="mr_1 date_picker">
        <input
          matInput
          [max]="maxDate"
          [matDatepicker]="from_picker"
          [(ngModel)]="from_date"
          (dateChange)="fromdateChabge()"
          readonly
          placeholder="{{'admin.lgn_his.from_date'|translate}}"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="from_picker"
        ></mat-datepicker-toggle>
        <mat-datepicker #from_picker></mat-datepicker>
      </mat-form-field>
      <mat-form-field appearance="outline" class="mr_1 date_picker">
        <input
          matInput
          [min]="tomindate"
          [max]="maxDate"
          [matDatepicker]="to_picker"
          [(ngModel)]="to_date"
          (dateChange)="todateChabge()"
          [disabled]="is_todate"
          readonly
          placeholder="{{'admin.lgn_his.to_date'|translate}}"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="to_picker"
        ></mat-datepicker-toggle>
        <mat-datepicker #to_picker></mat-datepicker>
      </mat-form-field>
      <button
        mat-raised-button
        color="accent"
        class="float_right mr_1 btn_st_frm"
        (click)="applyFilters()"
        [disabled]="is_submit"
      >
      {{"submit"|translate}}
      </button>
      <button
        mat-raised-button
        color="warn"
        class="float_right mr_1 btn_st_frm"
        (click)="resetFilters()"
        matTooltip="{{'admin.lgn_his.reset'|translate}}"
      >
        <mat-icon>restart_alt</mat-icon>
      </button>
      <span class="download_icons">
        <a
        href="{{ api_url }}export-login-history/PDF/{{
          search_txt ? search_txt : 0
        }}/{{ fromDate ? fromDate : 0 }}/{{ toDate ? toDate : 0 }}/{{user_id}}"
        mat-icon-button
        color="accent"
        class="float_right mr_1"
        type="button"
        matTooltip="{{'admin.lgn_his.download_pdf'|translate}}"
        matTooltipPosition="above"
        ><mat-icon>picture_as_pdf</mat-icon></a>
      <a
        href="{{ api_url }}export-login-history/EXL/{{
          search_txt ? search_txt : 0
        }}/{{ fromDate ? fromDate : 0 }}/{{ toDate ? toDate : 0 }}/{{user_id}}"
        mat-icon-button
        color="accent"
        class="float_right"
        type="button"
        ><mat-icon matTooltip="{{'admin.lgn_his.download_excel'|translate}}" matTooltipPosition="above"
          >description</mat-icon
        ></a>
      </span>
    </div>
    <div class="rsp_tbl">
      <table
        mat-table
        (matSortChange)="sortData($event)"
        class="mat-elevation-z8"
        [dataSource]="dataSource"
        matSort
      >
        <ng-container matColumnDef="pk_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="s_no">{{"s_no_text"|translate}}</th>
          <td mat-cell *matCellDef="let element" class="s_no">{{ element.s_no }}</td>
        </ng-container>
        <ng-container matColumnDef="first_name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.name"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.email"|translate}}</th>
          <td mat-cell *matCellDef="let element">
            {{ element.email ? element.email : "-" }}
          </td>
        </ng-container>
        <ng-container matColumnDef="latitude">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.latitude"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.latitude }}</td>
        </ng-container>
        <ng-container matColumnDef="longitude">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.longitude"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.longitude }}</td>
        </ng-container>
        <ng-container matColumnDef="country_name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.country"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.country_name }}</td>
        </ng-container>
        <ng-container matColumnDef="city_name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.city"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.city_name }}</td>
        </ng-container>
        <ng-container matColumnDef="platform_name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.platform_name"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.platform_name }}</td>
        </ng-container>
        <ng-container matColumnDef="device_type">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.device_type"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.device_type }}</td>
        </ng-container>
        <ng-container matColumnDef="browser">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.browser"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.browser }}</td>
        </ng-container>
        <ng-container matColumnDef="ip_v4_address">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.ip_address"|translate}}</th>
          <td mat-cell *matCellDef="let element">
            {{ element.ip_v4_address }}
          </td>
        </ng-container>
        <ng-container matColumnDef="login_time">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.login_time"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.login_time }}</td>
        </ng-container>
        <ng-container matColumnDef="logout_time">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"admin.lgn_his.logout_time"|translate}}</th>
          <td mat-cell *matCellDef="let element">{{ element.logout_time }}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        <tr class="mat-row no_rcrds_fd" *matNoDataRow>
          <td class="mat-cell" [attr.colspan]="displayedColumns.length">{{"no_records_found_text"|translate}}</td>
        </tr>
      </table>
    </div>
    <mat-paginator
      #paginator
      [pageSize]="pageSize"
      [length]="num_rows"
      [pageSizeOptions]="page_size_options"
      [showFirstLastButtons]="true"
      (page)="getServerData($event)"
    ></mat-paginator>
  </div>
</div>
