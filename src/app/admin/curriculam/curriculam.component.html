<app-admin-topbar></app-admin-topbar>
<app-sidebar></app-sidebar>
<div class="mn_dshbrd">
  <div class="cust_mdl_par" [ngClass]="{ cust_mdl_opn: model_status }">
    <div class="cust_mdl_chl">
      <button
        mat-icon-button
        (click)="toggleModel()"
        color="accent"
        class="float_right"
      >
        <mat-icon>close</mat-icon>
      </button>
      <div class="tbbd_bdy">
        <form
          id="curriculum_form"
          #curriculum_form="ngForm"
          name="curriculum_form"
          (ngSubmit)="curriculum_form.valid && createCurriculum()"
          novalidate
        >
          <div class="pg_ttl">Create Curriculum</div>
          <div
            class="tbbd_bdy_cnt inp_par_dv"
            [ngClass]="{
              err_tltp_par: curriculum_form.submitted && curriculum_name == ''
            }"
          >
            Curriculum Name
            <input
              matInput
              [(ngModel)]="curriculum_name"
              #curriculum_name_name="ngModel"
              name="curriculum_name_name"
              type="text"
              placeholder="Provide Curiculum Name"
              required
            />
            <span
              class="prc_tltp"
              *ngIf="curriculum_form.submitted && curriculum_name_name.invalid"
            >
              Curriculum Name is required</span
            >
          </div>
          <div
            class="tbbd_bdy_cnt"
            *ngFor="
              let step of steps;
              let indexOfelement = index;
              let last = last
            "
          >
            <div
              class="inp_par_dv"
              [ngClass]="{
                err_tltp_par:
                  curriculum_form.submitted &&
                  (steps[step] == '' || steps[step] == undefined)
              }"
            >
              Step {{ indexOfelement + 1 }}
              <input
                matInput
                type="text"
                name="{{ step }}"
                [(ngModel)]="steps[step]"
                #ref_{{step}}="ngModel"
                required
                placeholder="Provide Step {{ indexOfelement + 1 }} Label"
              />
              <span
                class="prc_tltp"
                *ngIf="curriculum_form.submitted && 'ref_' + step.invalid"
              >
                Step {{ indexOfelement + 1 }} is required</span
              >
            </div>
            <button
              type="button"
              *ngIf="last"
              (click)="addStep()"
              mat-raised-button
              color="accent"
            >
              +
            </button>
            <button
              type="button"
              (click)="removeStep(indexOfelement)"
              mat-raised-button
              color="warn"
            >
              -
            </button>
          </div>
          <button mat-raised-button color="accent">Submit</button>
        </form>
      </div>
    </div>
  </div>
  <div class="brd_crm">Proceum &raquo; <strong>Curriculum</strong></div>
  <div class="pg_ttl">Curriculums</div>
  <hr />
  <div class="dsh_brd_crds">
    <mat-form-field appearance="none">
      <input
        matInput
        type="text"
        (keyup)="doFilter($event.target.value)"
        placeholder="Search"
      />
    </mat-form-field>

    <button
      mat-raised-button
      color="accent"
      class="float_right"
      (click)="toggleModel()"
      type="button"
    >
      New Curriculum
    </button>
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      class="mat-elevation-z8"
      cdkDropList
      cdkDropListOrientation="horizontal"
      (cdkDropListDropped)="drop($event)"
    >
      <!-- Position Column -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>No.</th>
        <td mat-cell *matCellDef="let element">
          {{ element.id }}
        </td>
      </ng-container>

      <ng-container matColumnDef="Curriculum Name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>
          Curriculum Name
        </th>
        <td mat-cell *matCellDef="let element">
          <span (click)="navigateTo(element.id)">{{ element.name }}</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef cdkDrag>Status</th>
        <td mat-cell *matCellDef="let element">
          {{ element.status == 1 ? "Active" : "In Activated" }}
        </td>
      </ng-container>

      <ng-container matColumnDef="created_at">
        <th mat-header-cell *matHeaderCellDef cdkDrag>Created Date</th>
        <td mat-cell *matCellDef="let element">{{ element.created_at }}</td>
      </ng-container>

      <!-- Symbol Column -->
      <ng-container matColumnDef="updated_at">
        <th mat-header-cell *matHeaderCellDef cdkDrag>Updated Date</th>
        <td mat-cell *matCellDef="let element">{{ element.updated_at }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Action</th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button (click)="editCurriculum(element)">
            <mat-icon>edit</mat-icon>
          </button>
          <button
            title="{{
              element.status == 1 ? 'Click to deactivate' : 'Click to activate'
            }}"
            mat-icon-button
            mwlConfirmationPopover
            [popoverTitle]="'Are you sure?'"
            [popoverMessage]="
              'are you sure to change status of <b>' +
              element.name +
              '</b> Curriculum'
            "
            placement="top"
            (confirm)="deleteCurriculum(element.id, element.status)"
            confirmButtonType="danger"
            cancelButtonType="outline-secondary"
          >
            <mat-icon *ngIf="element.status == 1">visibility_off</mat-icon>
            <mat-icon *ngIf="element.status == 0">visibility</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      <tr class="mat-row" *matNoDataRow>
        <td
          style="text-align: center; margin: 20px"
          class="mat-cell"
          colspan="6"
        >
          No Records Found
        </td>
      </tr>
    </table>
    <mat-paginator
      [pageSizeOptions]="[5, 10, 20]"
      showFirstLastButtons
      (page)="getServerData($event)"
    ></mat-paginator>
  </div>
</div>
<div class="cust_mdl_par" [ngClass]="{ cust_mdl_opn: edit_model_status }">
  <div class="cust_mdl_chl">
    <button
      mat-icon-button
      (click)="edit_model_status = !edit_model_status"
      color="accent"
      class="float_right"
    >
      <mat-icon>close</mat-icon>
    </button>
    <div class="tbbd_bdy">
      <form
        id="edit_curriculum_form"
        #edit_curriculum_form="ngForm"
        name="edit_curriculum_form"
        (ngSubmit)="edit_curriculum_form.valid && updateCurriculum()"
        novalidate
      >
        <div class="pg_ttl">Edit Curriculum</div>
        <div
          class="tbbd_bdy_cnt inp_par_dv"
          [ngClass]="{
            err_tltp_par:
              edit_curriculum_form.submitted && curriculum_name == ''
          }"
        >
          Curriculum Name
          <input
            matInput
            [(ngModel)]="curriculum_name"
            #curriculum_name_name="ngModel"
            name="curriculum_name_name"
            type="text"
            placeholder="Provide Curiculum Name"
            required
          />
          <span
            class="prc_tltp"
            *ngIf="
              edit_curriculum_form.submitted && curriculum_name_name.invalid
            "
          >
            Curriculum Name is required</span
          >
        </div>
        <button mat-raised-button color="accent">Submit</button>
      </form>
    </div>
  </div>
</div>

<app-admin-footer></app-admin-footer>
