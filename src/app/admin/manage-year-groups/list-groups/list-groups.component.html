<div class="mn_dshbrd">
    <div class="brd_crm">
        Proceum &raquo; <strong>Manage {{ page_title }} </strong>
    </div>
    <div class="pg_ttl">Manage {{ page_title }}</div>
    <hr />

    <div class="dsh_brd_crds">
        <mat-form-field appearance="outline">
            <input matInput [(ngModel)]="search_box" (keyup)="$event.keyCode == 13 ? doFilter() : ''"
                placeholder="Search" />
            <mat-icon (click)="doFilter()" matSuffix>search</mat-icon>
        </mat-form-field>
        <button mat-raised-button color="accent" class="float_right margin-bottom_20"
        (click)="toggleModel()" type="button">
            Add New
        </button>
        <div class="rsp_tbl">
            <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">
                <!-- Position Column -->
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef>S.No</th>
                    <td mat-cell *matCellDef="let element">
                        {{ element.s_no }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>
                        Semester
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span>{{ element.name }}</span>
                    </td>
                </ng-container>
                <ng-container matColumnDef="year_name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>
                        Year
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span>{{ element.year_name }}</span>
                    </td>
                </ng-container>
                <ng-container matColumnDef="semester_name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>
                        Semeseter
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span>{{ element.semester_name }}</span>
                    </td>
                </ng-container>
                
                <ng-container matColumnDef="organization_name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>
                        Orgnization Name
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span>{{ element.organization_name }}</span>
                    </td>
                </ng-container>

                <ng-container matColumnDef="partner_type">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header cdkDrag>
                        Organization Type
                    </th>
                    <td mat-cell *matCellDef="let element">
                        <span>{{ element.partner_type }}</span>
                    </td>
                </ng-container>

                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef cdkDrag>Status</th>
                    <td mat-cell *matCellDef="let element">
                        <mat-slide-toggle (click)="changeStatus(element.id, element.status)" [checked]="element.status == 1 ? true : false" matTooltip="{{element.status == 1 ? 'Make Inactive' : 'Make Active'}}"></mat-slide-toggle>
                    </td>
                </ng-container>

                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>Actions</th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button matTooltip="Click to " color="accent"
                            (click)="getRow(element.id)">
                            <mat-icon>edit_note</mat-icon>
                        </button>
                        <button mwlConfirmationPopover [popoverTitle]="'Are you sure?'"
                                [popoverMessage]="
                            'Are you sure to delete <b>' + element.name + '</b> '
                            " placement="left" (confirm)="deleteRecord(element.id)" confirmButtonType="danger"
                                cancelButtonType="outline-secondary" mat-icon-button color="warn" matTooltip="Delete">
                            <mat-icon>remove_circle_outline</mat-icon>
                        </button>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                <tr class="mat-row no_rcrds_fd" *matNoDataRow>
                    <td class="mat-cell" [attr.colspan]="displayedColumns.length">No Records Found</td>
                </tr>
            </table>
        </div>
        <mat-paginator [pageSizeOptions]="page_size_options" showFirstLastButtons (page)="getServerData($event)">
        </mat-paginator>
    </div>
</div>

<div class="cust_mdl_par cust_mdl_50p" [ngClass]="{ cust_mdl_opn: model_status }">
    <div class="cust_mdl_chl">
      <div class="pg_ttl">
        Add New  {{ page_title }}
        <span class="spacer"></span>
        <button type="button" mat-icon-button (click)="model_status = false">
          &#x2715;
        </button>
      </div>
      <form id="create_form" #create_form="ngForm" name="create_form"
        (ngSubmit)="create_form.valid && createNew()" novalidate>
        <div class="tbbd_bdy">
          <div class="grd_2c no_bxsdw">
            <span class="text-right w_100p rqrd_txtinfo">
              All <span class="required">( * ) </span>marked fields are
              mandatory</span>
            <div class="hgt_20"></div>
            <div class="frm_dvs" *ngIf="show_radio">
                <span>Adding For!<span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-radio-group name="self_or_other" [(ngModel)]="self_or_other" (ngModelChange)="onAddingForChange()" required>
                            <mat-radio-button name="self_or_other" value="self">Proceum</mat-radio-button>
                            <mat-radio-button name="self_or_other" value="other">Partners
                            </mat-radio-button>
                        </mat-radio-group>
                    </span>
                </span>
            </div>
            <div class="hgt_20"></div>
            <div class="frm_dvs">
                <span>{{ page_title }} Name<span class="required">*</span></span>
                <span>
                  <span class="err_tltp_par">
                    <mat-form-field appearance="outline">
                      <input maxlength="30" appAlphaNumericOnly required name="title" [(ngModel)]="name_of" matInput
                        placeholder="{{ page_title }} Name" #title="ngModel" />
                    </mat-form-field>
                    <span class="prc_tltp" *ngIf="
                        (create_form.submitted || title.touched) &&
                        title.invalid
                      ">{{ page_title }} name is required</span>
                  </span>
                </span>
            </div>

            <div class="frm_dvs" *ngIf="self_or_other == 'other'">
                <span>Organization Type <span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-form-field appearance="outline">
                            <mat-select placeholder="Select Organization Type" name="organization_edit" #organization_edit="ngModel" [(ngModel)]="organization_type" (ngModelChange)="onOrganizationTypeChange()" required>
                                <mat-option *ngFor="let item of organization_types" [value]="item.value">{{ item.viewValue }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <span *ngIf="(create_form.submitted || organization_edit.touched) &&
                            organization_edit.invalid" class="prc_tltp">Organization Type is required
                        </span>
                    </span>
                </span>
            </div>
            <div class="frm_dvs"  *ngIf="self_or_other == 'other' && organization_type == '1'">
                <span>Select University <span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-form-field appearance="outline">
                            <mat-select placeholder="Select University" name="university_edit" #university_edit="ngModel"
                                [(ngModel)]="organization" (ngModelChange)="getYears(organization,null)" required>
                                <mat-option>
                                    <ngx-mat-select-search [noEntriesFoundLabel]="'No University found'"
                                        [placeholderLabel]="'Search University'" name="search_university" ngModel
                                        (ngModelChange)="filterUniversity($event)">
                                    </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let item of all_universities | async" [value]="item['pk_id']">{{ item["name"] }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        <span *ngIf="(create_form.submitted || university_edit.touched) && university_edit.invalid"
                            class="prc_tltp">
                            University is required
                        </span>
                    </span>
                </span>
            </div>

            <div class="frm_dvs"  *ngIf="self_or_other == 'other' && organization_type == '2'">
                <span>Select College <span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-form-field appearance="outline">
                            <mat-select placeholder="Select College" name="college_edit" #college_edit="ngModel"
                                [(ngModel)]="organization"  (ngModelChange)="getYears(organization,null)" required>
                                <mat-option>
                                    <ngx-mat-select-search [noEntriesFoundLabel]="'No College found'"
                                        [placeholderLabel]="'Search College'" name="search_college" ngModel
                                        (ngModelChange)="filterCollege($event)">
                                    </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let item of all_colleges | async" [value]="item['pk_id']">{{ item["name"] }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        <span *ngIf="(create_form.submitted || college_edit.touched) && college_edit.invalid"
                            class="prc_tltp">
                            College is required
                        </span>
                    </span>

                </span>
            </div>

            <div class="frm_dvs"  *ngIf="self_or_other == 'other' && organization_type == '3'">
                <span>Select Institute <span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-form-field appearance="outline">
                            <mat-select placeholder="Select Institute" name="institute_edit" #institute_edit="ngModel"
                                [(ngModel)]="organization"  (ngModelChange)="getYears(organization,null)" required>
                                <mat-option>
                                    <ngx-mat-select-search [noEntriesFoundLabel]="'No Institute found'"
                                        [placeholderLabel]="'Search Institute'" name="search_institite" ngModel
                                        (ngModelChange)="filterInstitute($event)">
                                    </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let item of all_institutes | async" [value]="item['pk_id']">{{ item["name"] }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        <span *ngIf="(create_form.submitted || institute_edit.touched) && institute_edit.invalid"
                            class="prc_tltp">
                            Institute is required
                        </span>
                    </span>

                </span>
            </div>
            
            <div class="frm_dvs" *ngIf="(self_or_other == 'other' && organization != '') || self_or_other == 'self'">
                <span>Select Year <span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-form-field appearance="outline">
                            <mat-select placeholder="Select Year" name="year_edit" #year_edit="ngModel" [(ngModel)]="year_id" (ngModelChange)="getSemesters(organization,year_id)" required>
                                <mat-option>
                                    <ngx-mat-select-search [noEntriesFoundLabel]="'No Year found'"
                                        [placeholderLabel]="'Search Year'" name="search_year" ngModel
                                        (ngModelChange)="filterYear($event)">
                                    </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let item of all_years | async" [value]="item['pk_id']">{{ item["name"] }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <span *ngIf="(create_form.submitted || year_edit.touched) &&
                            year_edit.invalid" class="prc_tltp">Organization Type is required
                        </span>
                    </span>
                </span>
            </div>

            <div class="frm_dvs" *ngIf="(self_or_other == 'other' && organization != '' && year_id != '') || (self_or_other == 'self' && year_id != '')">
                <span>Select Semester <span class="required">*</span></span>
                <span>
                    <span class="err_tltp_par">
                        <mat-form-field appearance="outline">
                            <mat-select placeholder="Select Semester" name="semester_edit" #semester_edit="ngModel" [(ngModel)]="semester_id" required>
                                <mat-option>
                                    <ngx-mat-select-search [noEntriesFoundLabel]="'No Semester found'"
                                        [placeholderLabel]="'Search Semester'" name="search_semester" ngModel
                                        (ngModelChange)="filterSemester($event)">
                                    </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngFor="let item of all_semesters | async" [value]="item['pk_id']">{{ item["name"] }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        <span *ngIf="(create_form.submitted || semester_edit.touched) &&
                            semester_edit.invalid" class="prc_tltp">Semester is required
                        </span>
                    </span>
                </span>
            </div>
            
            
          </div>
        </div>
        <hr />
        <button mat-raised-button color="accent" class="float_right mr_1">
          Submit
        </button>
        <button type="button" mat-raised-button class="float_right mr_1 gry_btn" (click)="model_status = false">
          Close
        </button>
      </form>
      <div class="hgt_20"></div>
    </div>
</div>


