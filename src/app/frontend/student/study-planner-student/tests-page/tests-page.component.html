<!-- <app-topbar class="inner-header"></app-topbar>
<app-sidemenu></app-sidemenu> -->
<div class="mn_dshbrd">
    <div class="hgt_20"></div>
    <div class="tsts_mn">
        <div class="tsts_qstns_nums">
            <div class="tstsnms_hd_dv">
                <div class="tstsnms_hd">Questions ({{questions_list.length}})</div>
                <div class="spacer"></div>
                <div class="tsts_qst_swch">
                    <mat-icon (click)="show_q_numbers = !show_q_numbers" color="accent">format_list_bulleted</mat-icon>
                </div>
            </div>
            <div class="hgt_20"></div>
            <div class="tstsnms_cnt_dv">
                <ul>
                    <!-- <li class="grn">1</li>
                    <li class="rd">2</li>
                    <li class="orng">3</li>
                    <li class="gry">4</li> -->
                    <li *ngFor="let q of questions_list; let question_index=index;"
                        class="{{question_index == active_q_index?'grn':''}} {{(q['answer'].length>0) && (question_index != active_q_index)?'gry':''}}"
                        (click)="getQuestionOptions(question_index)">{{question_index+1}}</li>
                </ul>
            </div>
        </div>
        <div class="tsts_qstns" *ngIf="questions_list.length>0">
            <div class="tstsqst_hd">Question ({{active_q_index+1}}/{{questions_list.length}})</div>
            <div class="hgt_20"></div>
            <div class="tstsqst_qst">
                <span [innerHTML]="active_question['question']"></span>
                <div class="tstsqst_img"
                    *ngIf='[10,11,12].includes(active_question["q_type"]) && active_question["q_source_value"]'>
                    <img [src]="bucket_url+active_question['q_source_value']" alt="">
                </div>
                <div class="tstsqst_img"
                    *ngIf='[4,5,6].includes(active_question["q_type"]) && active_question["q_source_value"]'>
                    <audio controls controlsList="nodownload">
                        <source [src]="bucket_url+active_question['q_source_value']" type="audio/mpeg">
                    </audio>
                </div>
                <div class="tstsqst_img"
                    *ngIf='[7,8,9].includes(active_question["q_type"]) && active_question["q_source_value"]'>

                    <div *ngIf="active_question['q_source'] == 'YOUTUBE'">
                        <iframe
                            [src]='active_question["q_source_value"].replace("/watch?v=","/embed/") | safe: "resourceUrl"'
                            frameborder="0" allowfullscreen></iframe>
                    </div>

                    <div *ngIf="active_question['q_source'] == 'KPOINT'">
                        <iframe [src]='kpoint_iframe_url | safe: "resourceUrl"' allowFullScreen webkitallowFullScreen
                            mozallowFullScreen frameborder="0"></iframe>
                    </div>
                </div>
            </div>
            <div class="tstsqst_ans">
                <mat-radio-group class="actvfr_dsc" *ngIf='[1,3,4,6,7,9,10,12,13].includes(active_question["q_type"])'
                    [(ngModel)]="active_question['answer'][0]">
                    <div *ngFor="let option of active_question['options']">
                        <mat-radio-button [value]="option['pk_id']" class="actvfr_dsc">{{ option["option_text"] }}</mat-radio-button>
                        <div class="rdo_desc" *ngIf="active_question['q_source'] == 'IMAGE' && option['option_image']">
                            <div class="tstsqst_img">
                                <img [src]="bucket_url+option['option_image']" />
                            </div>
                        </div>
                        <div class="rdo_desc"
                            *ngIf="active_question['show_answer'] && option['option_explanation'] != null && option['option_explanation'].trim() != ''">
                            <span [innerHtml]="option['option_explanation']"></span>
                        </div>
                    </div>
                </mat-radio-group>
                <div *ngIf='[2,5,8,11].includes(active_question["q_type"])' class="rdo_desc">
                    <div *ngFor="let option of active_question['options']; let i_option = index">
                        <mat-checkbox class="actvfr_dsc"
                            [checked]="active_question['answer'].includes(''+option['pk_id'])"
                            (change)="setAnswer($event,option['pk_id'])">{{ option["option_text"] }}</mat-checkbox>
                        <div class="rdo_desc">
                            <div class="tstsqst_img">
                                <img *ngIf="active_question['q_source'] == 'IMAGE' && option['option_image']"
                                    [src]="bucket_url+option['option_image']" />
                            </div>
                            <div
                                *ngIf="active_question['show_answer'] && option['option_explanation'] != null && option['option_explanation'].trim() != ''">
                                <div class="qstn_hds">Explanation</div>
                                <div [innerHtml]="option['option_explanation']"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tstsqst_navs" *ngIf="questions_list.length>0">
                <button mat-raised-button color="accent" [disabled]="active_q_index == 0"
                    (click)="getQuestionOptions(active_q_index-1)">
                    <mat-icon>arrow_left</mat-icon> Prev
                </button>
                <button [disabled]="active_question['answer'].length==0" mat-raised-button color="accent"
                    (click)="checkAnswer()" class="skp_btn">Check Answer <mat-icon>subdirectory_arrow_right
                    </mat-icon>
                </button>
                <button mat-raised-button color="accent" [disabled]="active_q_index == (questions_list.length-1)"
                    (click)="getQuestionOptions(active_q_index+1)">Next <mat-icon>arrow_right</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>