<div class="mn_dshbrd">
    <div class="hgt_20"></div>
    <div class="sp_mn">
        <div class="brdcrm_br p_1 d-flex ai_cntr">
            <mat-icon color="accent">home</mat-icon>
            <mat-icon>navigate_next</mat-icon><strong routerLink="assessments/list">{{"student.assessments.exam.assessments" | translate}}</strong>
            <span *ngIf="assessment.length>0"><mat-icon>navigate_next</mat-icon><strong>{{assessment[0]['assessment_name']}}</strong></span>
        </div>
    </div>
    <div class="hgt_20"></div>
    <div class="tsts_mn stdy_md_qstns {{show_q_numbers == false ? 'tsts_collps':''}}">
        <div class="tsts_qstns_nums">
            <div class="tstsnms_hd_dv">
                <div class="tstsnms_hd">{{"student.assessments.exam.questions" | translate}}</div>
                <div class="spacer"></div>
                <div class="tsts_qst_swch {{show_q_numbers == false ? 'rot_90':'rot_0'}}">
                    <mat-icon color="accent" (click)="show_q_numbers = !show_q_numbers">menu_open</mat-icon>
                </div>
            </div>
            <div class="hgt_20"></div>
            <div class="tstsnms_cnt_dv">
                <ul class="tst_lgnds">
                    <li class="actv">{{"student.assessments.exam.active" | translate}}</li>
                    <li class="answrd">{{"student.assessments.exam.answered" | translate}}</li>
                    <li class="orng">{{"student.assessments.exam.marked" | translate}}</li>
                    <li class="skppd">{{"student.assessments.exam.skipped" | translate}}</li>
                </ul>
                <ul>
                    <li *ngFor="let q of questions_list; let question_index=index;"
                        class=" {{q['result']}} {{question_index == active_q_index?'actv':''}} {{q['answer'].length>0?'answrd':''}}"
                        (click)="getQuestionOptions(question_index)">{{question_index+1}} <span class="qstn_elb"><span
                                [innerHTML]="q['question']"></span></span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="tsts_qstns" *ngIf="questions_list.length>0">
            <div class="d-flex w_90p ai_cntr">
                <div class="tstsqst_hd">Question ({{active_q_index+1}}/{{questions_list.length}})</div>
                <div class="spacer"></div>
                <div class="mr_1">{{"student.assessments.exam.remain_time"|translate}}: {{remain_time}}</div>
                <div>
                    <button (click)="showResult();" *ngIf="is_test_end == false"
                        [disabled]="!allow_end_test && active_question['answer'].length == 0" mat-raised-button
                        class="skp_btn {{allow_end_test == false && active_question['answer'].length == 0 ? 'gry_btn':''}}">{{"student.assessments.exam.end" | translate}}
                    </button>
                </div>

            </div>

            <div class="hgt_20"></div>
            <div class="tstsqst_qst">
                <span [innerHTML]="active_question['question']"></span>
                <div class="tstsqst_img"
                    *ngIf='[10,11,12].includes(active_question["q_type"]) && active_question["q_source_value"]'>
                    <img [src]="bucket_url+active_question['q_source_value']" alt="">
                </div>
                <div class="tstsqst_img"
                    *ngIf='[4,5,6].includes(active_question["q_type"]) && active_question["q_source_value"]'>
                    <audio controls controlsList="nodownload">
                        <source [src]="bucket_url+active_question['q_source_value']" type="audio/mpeg">
                    </audio>
                </div>
                <div class="tstsqst_img"
                    *ngIf='[7,8,9].includes(active_question["q_type"]) && active_question["q_source_value"]'>

                    <div *ngIf="active_question['q_source'] == 'YOUTUBE'">
                        <iframe
                            [src]='active_question["q_source_value"].replace("/watch?v=","/embed/") | safe: "resourceUrl"'
                            frameborder="0" allowfullscreen></iframe>
                    </div>

                    <div *ngIf="active_question['q_source'] == 'KPOINT'">
                        <iframe [src]='kpoint_iframe_url | safe: "resourceUrl"' allowFullScreen webkitallowFullScreen
                            mozallowFullScreen frameborder="0"></iframe>
                    </div>
                </div>
            </div>
            <div class="tstsqst_ans">
                <mat-radio-group class="" *ngIf='[1,3,4,6,7,9,10,12,13].includes(active_question["q_type"])'
                    [(ngModel)]="active_question['answer'][0]">
                    <div *ngFor="let option of active_question['options']">
                        <mat-radio-button [value]="''+option['pk_id']"
                            (click)="questions_list[active_q_index]['result'] = ''"
                            class="{{active_question['show_answer'] && active_question['s_no'].includes(''+option['pk_id'])?'actvfr_dsc':''}} {{active_question['show_answer'] && !active_question['s_no'].includes(''+option['pk_id'])?'tstwrng_ans':''}}">
                            {{ option["option_text"] }}
                        </mat-radio-button>
                        <div class="tstsopt_img"
                            *ngIf="active_question['q_source'] == 'IMAGE' && option['option_image'] || option['option_image'] != null">
                            <img [src]="bucket_url+option['option_image']" />
                        </div>
                        <div class="rdo_desc"
                            *ngIf="active_question['show_answer'] && option['option_explanation'] != null && option['option_explanation'].trim() != ''">
                            <span [innerHtml]="option['option_explanation']"></span>
                        </div>
                    </div>
                </mat-radio-group>
                <div *ngIf='[2,5,8,11].includes(active_question["q_type"])'>
                    <div *ngFor="let option of active_question['options']; let i_option = index">
                        <mat-checkbox
                            class="{{active_question['show_answer'] && active_question['s_no'].includes(''+option['pk_id'])?'actvfr_dsc':''}} {{active_question['show_answer'] && !active_question['s_no'].includes(''+option['pk_id'])?'tstwrng_ans':''}}"
                            [checked]="active_question['answer'].includes(''+option['pk_id'])"
                            (change)="setAnswer($event,option['pk_id'])">{{ option["option_text"] }}</mat-checkbox>
                        <div class="tstsqst_img">
                            <img *ngIf="active_question['q_source'] == 'IMAGE' && option['option_image'] || option['option_image'] != null"
                                [src]="bucket_url+option['option_image']" />
                        </div>
                        <div class="rdo_desc"
                            *ngIf="active_question['show_answer'] && option['option_explanation'] != null && option['option_explanation'].trim() != ''">
                            <div class="qstn_hds">{{"student.assessments.exam.explanation"|translate}}</div>
                            <div [innerHtml]="option['option_explanation']"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tstsqst_navs" *ngIf="questions_list.length>0">
                <button mat-raised-button color="accent" [disabled]="active_q_index == 0"
                    (click)="getQuestionOptions(active_q_index-1)">
                    <mat-icon>arrow_left</mat-icon> {{"student.assessments.exam.prev"|translate}}
                </button>
                <button mat-raised-button class="skp_btn" (click)="skipQuestion(active_q_index)">
                    {{"student.assessments.exam.skip"|translate}}
                </button>
                <button mat-raised-button color="accent" [disabled]="active_q_index == (questions_list.length-1)"
                    (click)="getQuestionOptions(active_q_index+1)">{{"student.assessments.exam.next"|translate}} <mat-icon>arrow_right</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>